use-shipctl-master: &masterShipctl
  - pushd /tmp
  # - git clone https://github.com/trriplejay/node.git
  # - ./node/shipctl/$SHIPPABLE_NODE_ARCHITECTURE/$SHIPPABLE_NODE_OPERATING_SYSTEM/install.sh
  - popd


resources:
  - name: winParamsA
    type: params
    versionTemplate:
      params:
        paramsA_foo: bar
        paramsA_hello: world

  - name: winParamsB
    type: params
    versionTemplate:
      params:
        btest: true
  - name: winStateA
    type: state
  - name: winStateB
    type: state

jobs:
  - name: windowsSetup
    type: runSh
    runtime:
      nodePool: w16-byon
    steps:
      - IN: sample_pipelines_windowsReplicate_rSync
      - OUT: winStateA
      - TASK:
          script:
            - New-Item -Path . -Name "winStateATestFile.txt" -ItemType "file" -Value "This is a text string."
            - shipctl copy_file_to_resource_state winStateATestFile.txt winStateA
  - name: windowsReplicate
    type: runSh
    runtime:
      nodePool: w16-byon
    steps:
      - IN: windowsSetup
      - IN: winStateA
        switch: off
      - OUT: winStateB
      - TASK:
          script:
            - shipctl replicate winStateA winStateB
